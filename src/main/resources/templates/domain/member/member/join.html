<html layout:decorate="~{global/usrLayout}">

<head>
    <title>회원가입</title>
</head>

<body>
<div layout:fragment="content">
    <h1>회원가입</h1>

    <script>
        function submitJoinForm(form) {
            form.username.value = form.username.value.trim();

            if (form.username.value.length == 0) {
                toastWarning('사용자 ID를 입력해주세요.');
                form.username.focus();
                return;
            }

            form.password.value = form.password.value.trim();

            if (form.password.value.length == 0) {
                toastWarning('비밀번호를 입력해주세요.');
                form.password.focus();
                return;
            }

            form.passwordConfirm.value = form.passwordConfirm.value.trim();

            if (form.passwordConfirm.value.length == 0) {
                toastWarning('비밀번호 확인을 입력해주세요.');
                form.passwordConfirm.focus();
                return;
            }

            if (form.password.value != form.passwordConfirm.value) {
                toastWarning('비밀번호가 일치하지 않습니다.');
                form.passwordConfirm.focus();
                return;
            }

            form.nickname.value = form.nickname.value.trim();

            if (form.nickname.value.length == 0) {
                toastWarning('별명을 입력해주세요.');
                form.nickname.focus();
                return;
            }
            form.submit();
        }
        function sendNumber(){
            $("#mail_number").css("display","block");
            $.ajax({
                url:"/mail",
                type:"post",
                dataType:"json",
                data:{"mail" : $("#mail").val()},
                success: function(data){
                    alert("인증번호 발송");
                    $("#Confirm").attr("value",data);
                }
            });
        }

        function confirmNumber(){
            var number1 = $("#number").val();
            var number2 = $("#Confirm").val();

            if(number1 == number2){
                alert("인증되었습니다.");
            }else{
                alert("번호가 다릅니다.");
            }
        }


    </script>

    <form th:action method="POST" onsubmit="submitJoinForm(this); return false;">
        <div>
            <label>아이디</label>
            <input type="username" name="username" placeholder="Enter username">
        </div>
        <div style="width: 100%; display: flex">
            <label>이메일</label>
            <div id="mail_input" name="mail_input">
                <input type="text" name="mail" id="mail" placeholder="Enter email">
                <button type="button" id="sendBtn" name="sendBtn" onclick="sendNumber()">인증번호보내기</button>
            </div>
            <br>
            <div id="mail_number" name="mail_number" style="display: none">
                <input type="text" name="number" id="number" placeholder="인증번호 입력">
                <button type="button" name="confirmBtn" id="confirmBtn" onclick="confirmNumber()">이메일 인증</button>
            </div>
            <br>
            <input type="text" id="Confirm" name="Confirm" style="display: none" value="">
        </div>




        <div>
            <label>비밀번호</label>
            <input type="password" name="password" placeholder="Enter Password">
        </div>

        <div>
            <label>비밀번호 확인</label>
            <input type="password" name="passwordConfirm" placeholder="Enter Password">
        </div>
        <div>
            <label>닉네임</label>
            <input type="text" name="nickname" placeholder="Enter nickname">
        </div>
        <button type="submit">회원가입</button>
    </form>
</div>
</body>

</html>